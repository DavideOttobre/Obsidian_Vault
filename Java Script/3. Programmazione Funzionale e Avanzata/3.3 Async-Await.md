# ðŸ“œ 3.3 Async/Await

## Introduzione

**Async/Await** Ã¨ una sintassi piÃ¹ leggibile per gestire operazioni asincrone rispetto alle **Promises** e alle **callback**.

ðŸ“Œ **Vantaggi di `async/await`:**  
âœ… Semplice e piÃ¹ leggibile rispetto a `.then()` e `.catch()`.  
âœ… Evita il **callback hell**.  
âœ… Rende il codice piÃ¹ simile alla programmazione sincrona.

In questa sezione vedremo:

- Come usare `async` e `await`
- Gestire errori con `try...catch`
- Eseguire piÃ¹ operazioni in parallelo

---

## ðŸ”¹ 1. Creare una funzione `async`

ðŸ“Œ **Una funzione `async` restituisce sempre una Promise.**

```js
async function saluta() {
    return "Ciao!";
}

saluta().then(messaggio => console.log(messaggio)); // âž "Ciao!"
```

ðŸ“Œ **Ãˆ equivalente a:**

```js
function saluta() {
    return Promise.resolve("Ciao!");
}
```

âœ… **Possiamo usare `await` SOLO dentro funzioni `async`.**

---

## ðŸ”¹ 2. Usare `await` per operazioni asincrone

ðŸ“Œ **Esempio con `setTimeout()` (simulando una richiesta asincrona):**

```js
function attesa(ms) {
    return new Promise(resolve => setTimeout(resolve, ms));
}

async function esegui() {
    console.log("Inizio...");
    await attesa(2000); // Attende 2 secondi
    console.log("Fine dopo 2 secondi.");
}

esegui();
```

ðŸ“Œ **`await` ferma l'esecuzione della funzione fino a quando la Promise Ã¨ risolta.**

---

## ðŸ”¹ 3. Usare `fetch()` con `async/await`

âœ… **Esempio con `fetch()` per ottenere dati da un'API:**

```js
async function getDati() {
    let response = await fetch("https://jsonplaceholder.typicode.com/todos/1");
    let dati = await response.json();
    console.log(dati);
}

getDati();
```

ðŸ“Œ **Funzionamento:**

1. `fetch()` restituisce una Promise â†’ `await` aspetta la risposta.
2. `response.json()` converte la risposta in JSON.

---

## ðŸ”¹ 4. Gestire errori con `try...catch`

Se qualcosa va storto (es. server offline), possiamo usare `try...catch`.

```js
async function getDati() {
    try {
        let response = await fetch("https://jsonplaceholder.typicode.com/todos/1");
        if (!response.ok) {
            throw new Error("Errore HTTP: " + response.status);
        }
        let dati = await response.json();
        console.log(dati);
    } catch (errore) {
        console.error("Errore:", errore.message);
    }
}

getDati();
```

ðŸ“Œ **`try` prova a eseguire il codice, `catch` gestisce eventuali errori.**

---

## ðŸ”¹ 5. Eseguire piÃ¹ operazioni in parallelo

Se dobbiamo eseguire piÃ¹ operazioni **indipendenti**, possiamo usare `Promise.all()`.

```js
async function caricaDati() {
    let [utente, post] = await Promise.all([
        fetch("https://jsonplaceholder.typicode.com/users/1").then(res => res.json()),
        fetch("https://jsonplaceholder.typicode.com/posts/1").then(res => res.json())
    ]);

    console.log("Utente:", utente);
    console.log("Post:", post);
}

caricaDati();
```

ðŸ“Œ **`Promise.all()` esegue entrambe le richieste in parallelo, riducendo il tempo di attesa.**

---

## ðŸ”¹ 6. Eseguire Promises in sequenza

Se un'operazione dipende dal risultato della precedente, possiamo usare `await` in sequenza.

```js
async function sequenza() {
    console.log("Richiesta utente...");
    let utente = await fetch("https://jsonplaceholder.typicode.com/users/1").then(res => res.json());

    console.log("Richiesta post dell'utente...");
    let post = await fetch(`https://jsonplaceholder.typicode.com/posts?userId=${utente.id}`).then(res => res.json());

    console.log("Utente:", utente);
    console.log("Post:", post);
}

sequenza();
```

ðŸ“Œ **Ogni `await` aspetta che lâ€™operazione precedente sia completata.**

---

## ðŸ“Œ **Riepilogo**

|Metodo|Descrizione|
|---|---|
|`async function nome()`|Definisce una funzione asincrona|
|`await promise`|Aspetta che una Promise sia risolta|
|`try...catch`|Gestisce errori in `async/await`|
|`Promise.all([p1, p2])`|Esegue piÃ¹ operazioni in parallelo|
|`Promise.allSettled([p1, p2])`|Restituisce lo stato di tutte le Promises|

---

## Collegamenti utili

- **Prossimo argomento â†’ [[3.4 Programmazione funzionale]]**
- **Ripassa le Promises â†’ [[3.2 Promises]]**

---
