# ðŸ“œ 3.1 Callbacks

## Introduzione

Una **callback** Ã¨ una funzione passata come argomento a un'altra funzione e viene eseguita in seguito, spesso dopo un'operazione asincrona.

ðŸ“Œ **PerchÃ© usare le callback?**  
âœ… Sono fondamentali per la **programmazione asincrona** (es. richieste HTTP, timeout, eventi).  
âœ… Permettono di **eseguire codice dopo unâ€™operazione** senza bloccare il flusso.

In questa sezione vedremo:

- Come funzionano le callback
- Esempi pratici di callback
- Errori comuni con le callback

---

## ðŸ”¹ 1. Creare e usare una callback

Una callback Ã¨ una **funzione che viene passata come argomento** e chiamata in un secondo momento.

### âœ… **Esempio base di callback**

```js
function saluta(nome, callback) {
    console.log(`Ciao, ${nome}!`);
    callback();
}

function dopoSaluto() {
    console.log("Questa Ã¨ una callback eseguita dopo il saluto.");
}

saluta("Alice", dopoSaluto);
```

ðŸ“Œ **Spiegazione:**

1. `saluta()` accetta un nome e una funzione `callback`.
2. Dopo aver stampato il saluto, chiama `callback()`.
3. `dopoSaluto()` viene eseguita dopo `saluta()`.

---

## ðŸ”¹ 2. Callback con parametri

Le callback possono ricevere **parametri** quando vengono eseguite.

```js
function operazione(a, b, callback) {
    let risultato = callback(a, b);
    console.log("Risultato:", risultato);
}

function somma(x, y) {
    return x + y;
}

operazione(5, 3, somma); // âž "Risultato: 8"
```

ðŸ“Œ **Passiamo `somma` come callback, che esegue `a + b`.**

âœ… **Possiamo usare funzioni anonime come callback:**

```js
operazione(10, 2, function(x, y) {
    return x * y;
}); 
// âž "Risultato: 20"
```

---

## ðŸ”¹ 3. Callback asincrone

Le callback sono fondamentali per la **programmazione asincrona**, come `setTimeout()`.

### âœ… **Esempio con `setTimeout()`**

```js
console.log("Inizio operazione...");

setTimeout(function() {
    console.log("Operazione completata dopo 2 secondi.");
}, 2000);

console.log("In attesa...");
```

ðŸ“Œ **Output:**

```
Inizio operazione...
In attesa...
Operazione completata dopo 2 secondi.
```

ðŸ“Œ **PerchÃ©?**

- `setTimeout()` Ã¨ **asincrono**, quindi non blocca l'esecuzione.
- Il codice continua mentre il timer conta i 2 secondi.

---

## ðŸ”¹ 4. Callback annidate (Callback Hell)

Se si usano molte callback annidate, il codice diventa difficile da leggere.

### âŒ **Esempio di Callback Hell**

```js
setTimeout(() => {
    console.log("Operazione 1 completata...");
    setTimeout(() => {
        console.log("Operazione 2 completata...");
        setTimeout(() => {
            console.log("Operazione 3 completata...");
        }, 1000);
    }, 1000);
}, 1000);
```

ðŸ“Œ **Problema:** il codice diventa difficile da mantenere.  
ðŸ“Œ **Soluzione:** usare **Promises** o **Async/Await** (vedremo nei prossimi capitoli).

---

## ðŸ”¹ 5. Gestione degli errori nelle callback

Se una callback deve gestire errori, possiamo passare un **primo parametro dedicato allâ€™errore**.

```js
function fetchDati(callback) {
    let errore = false; // Simuliamo un errore

    if (errore) {
        callback("Errore nel recupero dei dati!", null);
    } else {
        callback(null, { nome: "Alice", etÃ : 25 });
    }
}

fetchDati((err, dati) => {
    if (err) {
        console.error("Errore:", err);
    } else {
        console.log("Dati ricevuti:", dati);
    }
});
```

ðŸ“Œ **Pattern comune nelle callback:**  
âœ… Il **primo argomento Ã¨ l'errore** (`err`).  
âœ… Il **secondo argomento Ã¨ il risultato** (`dati`).

---

## ðŸ“Œ **Riepilogo**

|Concetto|Descrizione|
|---|---|
|**Callback**|Funzione passata come argomento a un'altra funzione|
|**Callback con parametri**|Passa valori alla funzione callback|
|**Asincronia**|`setTimeout()` e altre funzioni asincrone usano callback|
|**Callback Hell**|Troppi annidamenti rendono il codice illeggibile|
|**Gestione errori**|Il primo parametro delle callback Ã¨ l'errore|

---

## Collegamenti utili

- **Prossimo argomento â†’ [[3.2 Promises]]**
- **Ripassa i moduli â†’ [[2.5 Moduli]]**

---
