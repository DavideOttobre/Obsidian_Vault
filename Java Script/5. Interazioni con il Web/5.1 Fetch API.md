# ðŸ“œ 5.1 AJAX e Fetch API

## Introduzione

AJAX (**Asynchronous JavaScript and XML**) permette di caricare dati da un server **senza ricaricare la pagina**.

ðŸ“Œ **Cosa impareremo?**  
âœ… Usare `fetch()` per ottenere dati da un server.  
âœ… Inviare dati con `POST`.  
âœ… Gestire errori nelle richieste HTTP.

---

## ðŸ”¹ 1. Usare `fetch()` per ottenere dati

`fetch()` Ã¨ il metodo moderno per fare richieste HTTP.

### âœ… **Esempio: Ottenere dati da unâ€™API**

```js
fetch("https://jsonplaceholder.typicode.com/todos/1")
    .then(response => response.json()) // Converte in JSON
    .then(data => console.log("Dati ricevuti:", data))
    .catch(error => console.error("Errore:", error));
```

ðŸ“Œ **Come funziona?**  
1ï¸âƒ£ `fetch()` invia una richiesta GET all'URL specificato.  
2ï¸âƒ£ `.json()` converte la risposta in formato JavaScript.  
3ï¸âƒ£ `.catch()` intercetta errori di rete o server.

---

## ðŸ”¹ 2. Inviare dati con `POST`

Possiamo inviare dati a un server con `fetch()` e il metodo `POST`.

### âœ… **Esempio: Inviare dati a un'API**

```js
fetch("https://jsonplaceholder.typicode.com/posts", {
    method: "POST",
    headers: {
        "Content-Type": "application/json"
    },
    body: JSON.stringify({
        titolo: "Nuovo Post",
        contenuto: "Questo Ã¨ un post di esempio."
    })
})
.then(response => response.json())
.then(data => console.log("Risposta server:", data))
.catch(error => console.error("Errore:", error));
```

ðŸ“Œ **Dettagli importanti:**  
âœ… `method: "POST"` indica che stiamo inviando dati.  
âœ… `headers` specifica che stiamo inviando JSON.  
âœ… `body` contiene i dati da inviare, convertiti in JSON.

---

## ðŸ”¹ 3. Gestire errori nelle richieste

Se un server risponde con un errore (es. `404 Not Found`), `fetch()` **non lo considera un errore** di default.

ðŸ“Œ **Controlliamo lo stato della risposta manualmente:**

```js
fetch("https://jsonplaceholder.typicode.com/todos/123456") // URL errato
    .then(response => {
        if (!response.ok) {
            throw new Error(`Errore HTTP: ${response.status}`);
        }
        return response.json();
    })
    .then(data => console.log("Dati:", data))
    .catch(error => console.error("Errore:", error.message));
```

âœ… **Ora possiamo gestire errori HTTP come `404` o `500`.**

---

## ðŸ”¹ 4. Usare `async/await` con `fetch()`

Per un codice piÃ¹ leggibile, possiamo usare `async/await`.

### âœ… **Esempio con `async/await`**

```js
async function getDati() {
    try {
        let response = await fetch("https://jsonplaceholder.typicode.com/todos/1");

        if (!response.ok) {
            throw new Error(`Errore HTTP: ${response.status}`);
        }

        let data = await response.json();
        console.log("Dati ricevuti:", data);
    } catch (error) {
        console.error("Errore:", error.message);
    }
}

getDati();
```

ðŸ“Œ **Vantaggi di `async/await`:**  
âœ… **PiÃ¹ leggibile** rispetto alle Promises.  
âœ… **Gestisce gli errori con `try...catch`**.

---

## ðŸ”¹ 5. Eseguire piÃ¹ richieste contemporaneamente

Usiamo `Promise.all()` per eseguire piÃ¹ richieste in parallelo.

### âœ… **Esempio: Ottenere piÃ¹ risorse contemporaneamente**

```js
async function getMultipli() {
    try {
        let [utente, post] = await Promise.all([
            fetch("https://jsonplaceholder.typicode.com/users/1").then(res => res.json()),
            fetch("https://jsonplaceholder.typicode.com/posts/1").then(res => res.json())
        ]);

        console.log("Utente:", utente);
        console.log("Post:", post);
    } catch (error) {
        console.error("Errore:", error.message);
    }
}

getMultipli();
```

ðŸ“Œ **Riduce il tempo di attesa eseguendo piÃ¹ richieste in parallelo.**

---

## ðŸ“Œ **Riepilogo**

|Metodo|Descrizione|
|---|---|
|`fetch(url)`|Esegue una richiesta HTTP GET|
|`fetch(url, { method: "POST", body: JSON.stringify(dati) })`|Esegue una richiesta POST con dati|
|`.then(response => response.json())`|Converte la risposta in JSON|
|`.catch(error => console.error(error))`|Gestisce errori di rete|
|`async/await`|Alternativa piÃ¹ leggibile alle Promises|
|`Promise.all([fetch1, fetch2])`|Esegue piÃ¹ richieste contemporaneamente|

---

## Collegamenti utili

- **Prossimo argomento â†’ [[5.2 Web Storage (localStorage e sessionStorage)]]**
- **Ripassa Animazioni e Transizioni â†’ [[4.4 Animazioni e Transizioni nel DOM]]**

---
